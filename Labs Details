using System.Net;
using System.Net.Http.Headers;

var siteUrl = "http://portal";
var folderRelativeUrl = "departments/tc/nsd/ss/Google Earth General/2025";

var handler = new HttpClientHandler
{
    UseDefaultCredentials = true,
};

using var client = new HttpClient(handler)
{
    BaseAddress = new Uri(siteUrl)
};

// Correct way: only "application/json" here
client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("application/json"));

// Build the endpoint
var endpoint = $"/_api/web/GetFolderByServerRelativeUrl('{Uri.EscapeDataString(folderRelativeUrl)}')";

var response = await client.GetAsync(endpoint);

if (response.IsSuccessStatusCode)
{
    var content = await response.Content.ReadAsStringAsync();
    Console.WriteLine("Folder accessed successfully!");
    Console.WriteLine(content);
}
else
{
    Console.WriteLine($"Failed to access folder: {response.StatusCode}");
}
